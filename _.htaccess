# ============================================
# .htaccess - Configuración Principal
# Separación Frontend/Backend
# ============================================

# Configuraciones básicas
Options -Indexes
DirectoryIndex public/index.html

# Habilitar mod_rewrite
RewriteEngine On

# ============================================
# RUTAS API - Máxima prioridad
# ============================================
# Capturar TODAS las rutas que empiecen con /api/
RewriteRule ^api/(.*)$ backend/api.php?route=$1 [QSA,L]

# ============================================
# ARCHIVOS ESTÁTICOS EXISTENTES
# ============================================
# Si el file existe físicamente, servirlo directamente
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# Si el directorio existe físicamente, servirlo directamente
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Permitir acceso a archivos compartidos
RewriteCond %{REQUEST_URI} ^/shared/
RewriteRule ^shared/(.*)$ shared/$1 [L]

# ============================================
# FRONTEND - Redirigir a public/
# ============================================
# Todo lo demás va a public/
RewriteCond %{REQUEST_URI} !^/backend/
RewriteRule ^(.*)$ public/$1 [L]